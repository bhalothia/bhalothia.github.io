---
layout: post
title: Schwartzian transform used in a C Program
date: '2010-12-12T18:00:00.015+05:30'
author: Saurabh
tags: 
- perl
- c
modified_time: '2010-12-12T23:18:33.673+05:30'
blogger_id: tag:blogger.com,1999:blog-590496507799049344.post-3474325356250782160
blogger_orig_url: http://curiosityhealsthecat.blogspot.com/2010/12/schwartzian-transform-used-by-c-program.html
---

If you are looking for an in depth explanation of the Schwartzian transform with an example, please refer to my earlier post -&nbsp;<a href="http://curiosityhealsthecat.blogspot.com/2010/11/schwartzian-transform-explained.html">Schwartzian Transform Explained</a> <br /><br />I was getting bored and asked a friend to give me something interesting to code in C. He being who he is, told me to write an implementation of the Schwartzian Transform (henceforth referred to as ST) in C. During the process of writing that program, I realized how Perl makes us focus on the problem at hand rather than the nuances of the language. This post aims provide the source and explain it.<br /><br />The source is uploaded here - <a href="https://github.com/saurabh-hirani/examples/blob/master/bin/c/schwartz.c" target="new">schwartz.c</a><br /><br />Now that the (fo|sou)rce is with you, I shall explain the main() function because all the other functions are called from main() and their body is easy to understand once you know their purpose in the main(). Or rather, their main() purpose.. <br /><a name='more'></a><br /><pre class="c" name="code">int main() {<br />    emp* emp_ptr_arr[MAXEMP];<br />    build_emp_list(emp_ptr_arr, MAXEMP);<br />    print_emp_list(emp_ptr_arr, MAXEMP);<br />    /* <br />      map { [$_, $_-&gt;get_salary] } <br />      @employees<br />    */<br />    store_sal_emp_ds* store_sal_emp_ds_ptr_arr[MAXEMP];<br />    build_store_sal_emp_ds(emp_ptr_arr, store_sal_emp_ds_ptr_arr, MAXEMP);<br />    /* <br />      sort { $a-&gt;[1] &amp;br;=&gt; $b-&gt;[1] } <br />      map { [$_, $_-&gt;get_salary] } <br />      @employees<br />    */<br />    qsort(store_sal_emp_ds_ptr_arr, MAXEMP, sizeof(store_sal_emp_ds*), salary_comparator);<br />    /*<br />      @sorted_emp = map { $_-&gt;[0] } <br />                    sort { $a-&gt;[1] &amp;br;=&gt; $b-&gt;[1] } <br />                    map { [$_, $_-&gt;get_salary] } <br />                    @employees<br />    */<br />    emp* sorted_emp_ptr_arr[MAXEMP];<br />    build_emp_list_frm_store_sal_emp_ds(store_sal_emp_ds_ptr_arr, sorted_emp_ptr_arr, MAXEMP);<br />    printf("----------------------------\n");<br />    print_emp_list(sorted_emp_ptr_arr, MAXEMP);<br />    return(0);<br />}<br /></pre><br /><br />line 02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : Declare an array which will hold the employees.<br /><br />line 03-04 : Build a sample dataset for this program and print it.<br /><br />line 05-10: Build the intermediate data structure which will hold the employee <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; instances as well as the salary for each employee. (the one time<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; storing part)<br /><br />line 11-16: Sort the intermediate data structure<br /><br />line 17-24: Extract what is needed from the intermediate data structure -<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the employee struct instances<br /><br />line 25-xx: Print the sorted array of employee struct instances.<br /><br />As you can see, you need a separate function to simulate each cascade of the map-sort-map construct in C. I haven't benchmarked this code against a simple sorting but I think the effort that goes into building the intermediate data structure, sorting it and extracting what is required in the above code would be costlier just sorting the employee instances directly. (Open to speculation)
