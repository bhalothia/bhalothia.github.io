---
layout: post
title: The "Read More" plugin and how blogger beat me to it
date: '2010-12-12T19:23:00.028+05:30'
author: Saurabh
tags: 
- blogging-platforms
modified_time: '2010-12-14T17:36:05.766+05:30'
blogger_id: tag:blogger.com,1999:blog-590496507799049344.post-7029657276057303372
blogger_orig_url: http://curiosityhealsthecat.blogspot.com/2010/12/read-more-plugin-and-how-blogger-beat.html
---

Edit: I have left blogger, wordpress for my techblog and moved to github pages as communicated <a href="http://curiosityhealsthecat.blogspot.in/2015/09/blogspot-we-need-to  -talk.html" target="_blank">here</a>. This post was written when I was trying to decide between blogger and wordpress.<br/><br/>For those who are searching for a way to add a "Read More" link to their blogspot blogs - <a href="http://www.bloggerplugins.org/2009/09/post-summaries-on-blogger-with-read.html" target="new">click here</a><br /><br />The rest of the post discusses the other "Read More" plugin that I found on the net, its limitations and how I wrote one myself (similar in its functionality to one in the above link) and its source code. Its a good study on how to preprocess your post after you click "PUBLISH POST" button but before blogger actually publishes it. The geeks may continue reading.<br /><br />Quite some time ago, I was writing a humor article on my blog - <a href="http://crashpoint-zeros-brain.blogspot.com/2008/11/barberic-creatures.html" target="new">Barberic Creatures</a> It badly needed a "Read More" link because as per the the setting I had, I display 10 posts on a page and if one of them is too long (this one was) it dissuades the reader from scrolling all the way down to see the other ones. I couldn't find any plugins at that time (2008/11) and left it at that.<br /><br />But it came back to haunt me when I wrote <a href="http://curiosityhealsthecat.blogspot.com/2010/11/schwartzian-transform-explained.html" target="new">Schwartzian Transform Explained</a>. This time I got a hit - <a href="http://www.snaphow.com/new-automatic-read-more-plugin-for-blogger-create-post-summary-widget-with-thumbnails/" target="new">Snaphow read more plugin </a><br /><br />The instructions were clear and it works. But it didn't address my needs because:<br /><a name='more'></a><ol><li>It inserts "Read More" link at the end of all pages - even the ones that are accommodated in the limits it imposes.</li><li>The link is inserted based on the character limit which implies that the author cannot decide the "logical" break point. I certainly wouldn't want it to display the first 3.7 lines of a poem followed by a read more link. That would break the flow.</li><li>It messes up formatting. The preview post that you see is one big paragraph without any line breaks.</li></ol>At that point, I didn't take Google's hand - I decided to write my own plugin - to do it my way and to see how blogger plugins work. The above plugin had a clean, understandable code and after going through it I wrote one which did the following:<br /><ol><li>The author decides where to break his post and the preview content to show to the reader.</li><li>To do this he inserts an HTML comment&nbsp; &lt;!-- cut_from_here --&gt; at the break point.</li><li>When the post is being published a javascream (read javascript) function takes the contents of the post, uses the "&lt;!-- cut_from_here --&gt;" as a delimiter and displays the first part (the part preceding the delimiter) followed by a "Bleed More" (just for kicks) link.</li><li>I gloat.</li></ol>Like the snaphow plugin, in order to add my plugin to your blogger template, one must do the following:<br /><ol><li> <b> DO NOT COPY PASTE THE CODE DIRECTLY </b>. This code has been rendered through SyntaxHighlighter plugin - click on the "view plain" link at the top of the code snippet, copy the code shown to you and before you paste it - run it through an HTML encoder. Here is one - <a href="http://www.opinionatedgeek.com/dotnet/tools/htmlencode/Encode.aspx" target="new">HTML Encoder</a></li><li>Go to your blog =&gt; Dashboard =&gt; Design =&gt; Download Full template. This is to backup your template. The author does not claim responsibility for any side effect caused by the suggested code changes in this post.</li><li>After backing up your template click on Edit HTML =&gt; Check on "Expand Widget Templates"</li><li>Replace <b>&lt;/head&gt; </b>with the following code&nbsp;</li><pre class="js" name="code"><script type="text/javascript"><br />    var cutPostAtPattern = "<!-- cut_from_here -->"; <br />    function getPostPreview(pID, blogPostUrl){<br />        var div = document.getElementById(pID);<br />        var doc = div.innerHTML;<br />        var patt_idx = doc.indexOf(cutPostAtPattern);<br />        var previewContent;<br />        if (patt_idx == -1) {<br />            previewContent = doc;   <br />        } else {<br />            splitContent = doc.split(cutPostAtPattern);<br />            var readMoreLink = "&lt;br/>&lt;br/>&lt;b>&lt;a href=" + blogPostUrl + ">Read More >></a></b>";<br />            previewContent = splitContent[0] + readMoreLink;<br />        }<br />        var preview = '&lt;div>' + previewContent + '&lt;/div>';<br />        div.innerHTML = preview;<br />     }    <br /></script> <br />&lt;/head&gt;<br /></pre><li> Replace &lt;<b>data:post.body</b>/&gt; with the following code</li><pre class="js" name="code">      &lt;b:if cond='data:blog.pageType == "item"'&gt;<br />      &lt;data:post.body/&gt;<br />      &lt;b:else/&gt;<br />      &lt;div expr:id='"preview" + data:post.id'&gt;<br />      &lt;data:post.body/&gt;<br />      &lt;/div&gt;<br />      &lt;script type='text/javascript'&gt;<br />        getPostPreview("preview&lt;data:post.id/&gt;", "&lt;data:post.url/&gt;");<br />      &lt;/script&gt;  <br />      &lt;/b:if&gt;&nbsp;</pre><li> Save the template </li><li> Edit the most current post of your blog to add &lt;!-- cut_from_here --&gt; at the point upto which you want the reader to see the preview.</li><li> Publish it and click on "View Blog" link. If you click on "View Post" the above code will display the entire post without the preview (will explain the reason soon) </li><li> Jump with joy or curse the author depending upon the outcome. </li></ol>Now comes the fun part. We dissect both the code snippets to see why they do the trick.<br /><br />First you decide when your javascript function will be called. That is done by the code in <b> Step 5 </b>. As you can see it is an if-else block. The condition it checks is:<br /><br /><pre class="js" name="code">      &lt;b:if cond='data:blog.pageType == "item"'&gt;<br />      &lt;data:post.body/&gt;<br />      &lt;b:else/&gt;<br /></pre><br />which means if the pageType is "item" - which means "a specific post" - then show the body as it is. Which makes sense, because if you clicked on a specific post there is no point in adding a "Read More" tag in it. The "Read More" tag is used to reduce the per-post-hog-limit on the index page of your blog. More information on pageType - <a href="http://www.bloggersentral.com/2010/08/targeting-specific-pages-with.html" target="new">here</a><br /><br />If the pageType is not "item" then:<br /><br /><pre class="js" name="code">      &lt;b:else/&gt;<br />      &lt;div expr:id='"preview" + data:post.id'&gt;<br />      &lt;data:post.body/&gt;<br />      &lt;/div&gt;<br />      &lt;script type='text/javascript'&gt;<br />        getPostPreview("preview&lt;data:post.id/&gt;", "&lt;data:post.url/&gt;");<br />      &lt;/script&gt;  <br /></pre><br />call the getPostPreview function with the post id and the post url and let it compress the post into a preview post. The <b>data:post.id</b>, <b>data:post.url</b> hold this meta-information.<br /><br />What goes on inside the getPostPreview function?<br /><br /><pre class="js" name="code"><script type="text/javascript"><br />    var cutPostAtPattern = "<!-- cut_from_here -->"; <br />    function getPostPreview(pID, blogPostUrl){<br />        var div = document.getElementById(pID);<br />        var doc = div.innerHTML;<br />        var patt_idx = doc.indexOf(cutPostAtPattern);<br />        var previewContent;<br />        if (patt_idx == -1) {<br />            previewContent = doc;   <br />        } else {<br />            splitContent = doc.split(cutPostAtPattern);<br />            var readMoreLink = "&lt;br/>&lt;br/>&lt;b>&lt;a href=" + blogPostUrl + ">Read More >></a></b>";<br />            previewContent = splitContent[0] + readMoreLink;<br />        }<br />        var preview = '&lt;div>' + previewContent + '&lt;/div>';<br />        div.innerHTML = preview;<br />     }    <br /></script>   <br /></pre><br />line 02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : Initialize the pattern at which the post will be split into 2 parts and only the first one<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (the one before the pattern) will be displayed.<br />line 05-06 : get the HTML corresponding to the post id.<br />line 07&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : get the point at which the cutPostAtPattern occurred.<br />line 10&nbsp; &nbsp;&nbsp;&nbsp; : if the pattern is not found, the preview content is equal to the document itself.<br />line 12-14 : if the pattern is found, split the content at that pattern and append the preview content with<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the "Read More" link.<br />line 16-17 : Place the preview content + link within a div and set it as the post's HTML content.<br /><br />This is just one example. You can replace the <b>getPostPreview</b> function by any function to preprocess your post before displaying it. A google search on the buzzwords - <b>data:blog.pageType</b>, <b>data:post.id</b>, etc. will give you many hits to know more about the tag syntax and meta information.<br /><br />When I was done testing this plugin (it has one small flaw which I leave for the reader to observe and point out), I wanted to submit it on some site that hosted blogger plugins. It was then that I found out that blogger had already integrated a similar feature in their rich text editor -&nbsp;<a href="http://www.bloggerplugins.org/2009/09/post-summaries-on-blogger-with-read.html" target="new">Read More</a> That's the one I used for adding a "Read More" link to this post. But I enjoyed the process as I got to know interesting things while working on the plugin. Hope you find this information useful while playing with blogger templates.
